"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[634,792],{4721:(e,t,a)=>{a.d(t,{Z:()=>o});var n=a(3645),r=a.n(n)()((function(e){return e[1]}));r.push([e.id,".p-inputtext:disabled{background-color:#6b7280!important;color:#fff!important;opacity:1!important}",""]);const o=r},792:(e,t,a)=>{a.r(t),a.d(t,{default:()=>se});var n=a(6598),r={class:"px-4 mt-5"},o={class:"w-12/12 ml-auto mr-auto mt-2 transform"},l={class:"flex"},i={class:"text-2xl text-white"},c={class:"flex ml-auto items-center"},s=[(0,n.createElementVNode)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"white",viewBox:"0 0 16 16"},[(0,n.createElementVNode)("path",{d:"M15.683 3a2 2 0 0 0-2-2h-7.08a2 2 0 0 0-1.519.698L.241 7.35a1 1 0 0 0 0 1.302l4.843 5.65A2 2 0 0 0 6.603 15h7.08a2 2 0 0 0 2-2V3zM5.829 5.854a.5.5 0 1 1 .707-.708l2.147 2.147 2.146-2.147a.5.5 0 1 1 .707.708L9.39 8l2.146 2.146a.5.5 0 0 1-.707.708L8.683 8.707l-2.147 2.147a.5.5 0 0 1-.707-.708L7.976 8 5.829 5.854z"})],-1)],d=["disabled"],u=[(0,n.createElementVNode)("svg",{width:"24",height:"24",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[(0,n.createElementVNode)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 13h6m-3-3v6m5 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)],p={key:0,class:"disabled:bg-indigo-800 bg-indigo-700 hover:bg-indigo-600 text-white font-medium rounded-lg text-sm px-2 py-2 text-center mr-2",id:"showReport"},m=[(0,n.createElementVNode)("svg",{width:"24",height:"24",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[(0,n.createElementVNode)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"})],-1)],f=[(0,n.createElementVNode)("svg",{width:"24",height:"24",fill:"none",stroke:"white",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[(0,n.createElementVNode)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)],h={class:"flex flex-col"},b={class:"w-11/12 mx-auto flex flex-row m-4"},g={class:"flex flex-col mt-2 mr-2"},x=(0,n.createElementVNode)("p",{class:"text-base text-white"},"Fecha",-1),y={class:"flex flex-col m-2"},v=(0,n.createElementVNode)("p",{class:"text-base text-white"},"Descripción",-1),w=["disabled"],V={class:"flex flex-col ml-auto mt-2"},k=(0,n.createElementVNode)("p",{class:"text-base text-white"},"Total",-1),N={class:"mt-1 text-xl text-white text-center self-center"},_={class:"w-11/12 mx-auto"},E=(0,n.createTextVNode)(" No hay artículos, añade uno! "),j={class:"flex flex-row justify-between gap-2 items-center"},O={class:"self-end mx-2"},C=(0,n.createElementVNode)("p",{class:"text-center"},"Número",-1),D={class:"text-center text-lg text-white m-4"},q={class:"self-end w-full"},S=(0,n.createElementVNode)("p",{class:"text-center"},"Artículo",-1),P={class:"self-end w-full"},I=(0,n.createElementVNode)("p",{class:"text-center"},"Cantidad",-1),T={class:"self-end w-full"},M=(0,n.createElementVNode)("p",{class:"text-center"},"Fecha de expiración",-1),B={class:"self-end w-full"},A=(0,n.createElementVNode)("p",{class:"text-center"},"Precio",-1),F={class:"self-end mb-1"},z=[(0,n.createElementVNode)("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[(0,n.createElementVNode)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 13h6m-3-3v6m5 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)],Z=["onClick"];var L=a(9680),Y=a(6635),U=a(7484),H=a.n(U),R=a(6076),X=a(2262),$=a(6252),G=a(8223),J=a(922),K=a(5247),Q=a(5090);function W(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function ee(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?W(Object(a),!0).forEach((function(t){te(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):W(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function te(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function ae(e){return function(e){if(Array.isArray(e))return ne(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return ne(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return ne(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ne(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}const re={components:{InputText:R.Z,Calendar:G.Z,DataTable:J.Z,Column:K.Z,Dropdown:Y.Z},props:{company:{type:Object,required:!0},userData:{type:Object,required:!0},details:{type:Object,default:{}}},emits:["goback","delete"],setup:function(e,t){var a=t.emit,n=function(e){return"Invalid Date"==H()(e).format("DD/MM/YYYY")?"":H()(e).format("DD/MM/YYYY")},r=(0,$.Fl)({get:function(){if(!(Object.keys(e.details).length>0))return e.company.articles.map((function(e){return{label:e.name,value:e.id_article}})).filter((function(e){return!l.table.some((function(t){return t.article.value==e.value}))}))}}),o=(0,$.Fl)((function(){var t=0;return e.company.notes.forEach((function(e){e.notes_lot.forEach((function(e){e.id_article==i.article.value&&(t+=1)}))})),t+1})),l=(0,X.qj)({number:(0,$.Fl)((function(){return 0==e.company.notes.length?1:Math.max.apply(Math,ae(e.company.notes.filter((function(e){return 1==e.type})).map((function(e){return e.number}))))+1})),date:"",description:"",total:(0,$.Fl)((function(){return l.table.map((function(e){return e.purchase_price*e.quantity})).reduce((function(e,t){return parseFloat(e)+parseFloat(t)}),0)})),id_receipt:"",table:[]}),i=(0,X.qj)({article:{},expiration_date:"",quantity:1,purchase_price:1}),c=function(){i.article={},i.expiration_date="",i.quantity=1,i.purchase_price=1};(0,$.bv)((function(){console.log("Montado",l.table),Object.keys(e.details).length>0&&(e.details.lot.forEach((function(e){l.table.push({number:e.pivot.id_note_lot,article_name:e.name,expiration_date_c:null==e.pivot.expiration_date?"Sin fecha de expiración":e.pivot.expiration_date,quantity:e.pivot.quantity,purchase_price:e.pivot.purchase_price,stock:e.pivot.stock,deleted_at:e.pivot.deleted_at})})),l.description=e.details.description,l.date=e.details.date)}));return{emitDelete:function(){a("delete"),a("goback")},actualLoteNumber:o,save:function(){var t=!0;if(0==l.table.length&&(Q.Notify.failure("Ingresa al menos un artículo"),t=!1),""==l.date&&(Q.Notify.failure("Ingresa una fecha"),t=!1),(""==l.description||l.description.length<3)&&(Q.Notify.failure("Ingresa una descripción de al menos 3 carácteres"),t=!1),t){var n={};l.table.forEach((function(e){n[e.article.value]={quantity:e.quantity,stock:e.quantity,id_note_lot:e.article.value,purchase_price:e.purchase_price,entry_date:l.date,expiration_date:e.expiration_date}}));var r={id_company:e.company.id_company,date:l.date,description:l.description,table:n,total:l.total};L.Inertia.post(route("notes.api.create_c"),r,{onSuccess:function(){Q.Notify.success("Nota de compra creada"),a("goback")},onError:function(e){for(var t in e)Q.Notify.failure(e[t])}})}},delete_that:function(e){l.table.splice(e-1,1)},nozero:function(){i.quantity=parseInt(i.quantity),i.stock=parseInt(i.stock),(""==i.quantity||i.quantity<=0)&&(i.quantity=1),(""==i.purchase_price||i.purchase_price<=0)&&(i.purchase_price=1),(""==i.stock||i.stock<=0)&&(i.stock=1)},goback:function(){a("goback")},values:l,valuesToPush:i,makeDate:n,articles_c:r,addRow:function(){var e;(e=!0,(""==i.quantity||i.quantity<=0)&&(Q.Notify.failure("Ingresa una cantidad mayor a 0"),e=!1),(""==i.purchase_price||i.purchase_price<=0)&&(Q.Notify.failure("Ingresa un precio"),e=!1),0==Object.keys(i.article).length&&(Q.Notify.failure("Ingresa un artículo"),e=!1),(""==i.stock||i.stock<=0)&&(Q.Notify.failure("Ingresa un stock mayor a 0"),e=!1),e)&&(l.table.push(ee(ee({},i),{},{number:o.value,id_category:l.categories,article_name:i.article.label,expiration_date:i.expiration_date,stock:i.quantity,expiration_date_c:""==n(i.expiration_date)?"Sin expiración":n(i.expiration_date)})),c())}}}};var oe=a(3379),le=a.n(oe),ie=a(4721),ce={insert:"head",singleton:!1};le()(ie.Z,ce);ie.Z.locals;const se=(0,a(3744).Z)(re,[["render",function(e,t,a,L,Y,U){var H=(0,n.resolveComponent)("Calendar"),R=(0,n.resolveComponent)("Dropdown"),X=(0,n.resolveComponent)("InputText"),$=(0,n.resolveComponent)("Column"),G=(0,n.resolveComponent)("DataTable");return(0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,null,[(0,n.createElementVNode)("div",r,[(0,n.createElementVNode)("div",o,[(0,n.createElementVNode)("div",l,[(0,n.createElementVNode)("h4",i,(0,n.toDisplayString)(Object.keys(a.details).length>0?"Viendo ":"Creando ")+" nota de compra Nº "+(0,n.toDisplayString)(Object.keys(a.details).length>0?a.details.number:L.values.number)+" "+(0,n.toDisplayString)(Object.keys(a.details).length>0?" | "+a.details.deleted_at:null),1),(0,n.createElementVNode)("div",c,[(0,n.createElementVNode)("button",{class:"bg-sky-600 hover:bg-sky-700 text-white font-medium rounded-lg text-sm p-2 text-center mr-2",onClick:t[0]||(t[0]=function(e){return L.goback()})},s),(0,n.createElementVNode)("button",{class:"bg-green-600 hover:bg-green-700 text-white font-medium rounded-lg text-sm p-2 text-center mr-2",onClick:t[1]||(t[1]=function(e){return L.save()}),disabled:Object.keys(a.details).length>0},u,8,d),Object.keys(a.details).length>0?((0,n.openBlock)(),(0,n.createElementBlock)("button",p,m)):(0,n.createCommentVNode)("",!0),Object.keys(a.details).length>0&&"Activo"==a.details.deleted_at?((0,n.openBlock)(),(0,n.createElementBlock)("button",{key:1,id:"trash_receipt",class:"text-white disabled:bg-red-800 bg-red-500 hover:bg-red-600 font-medium rounded-lg text-sm px-2 py-2 text-center",onClick:t[2]||(t[2]=function(e){return L.emitDelete()})},f)):(0,n.createCommentVNode)("",!0)])])])]),(0,n.createElementVNode)("div",h,[(0,n.createElementVNode)("div",b,[(0,n.createElementVNode)("div",g,[x,(0,n.createVNode)(H,{disabled:Object.keys(a.details).length>0,inputStyle:"background: white; color: black;",modelValue:L.values.date,"onUpdate:modelValue":t[3]||(t[3]=function(e){return L.values.date=e}),dateFormat:"dd/mm/yy"},null,8,["disabled","modelValue"])]),(0,n.createElementVNode)("div",y,[v,(0,n.withDirectives)((0,n.createElementVNode)("input",{disabled:Object.keys(a.details).length>0,class:"p-2 text-black rounded-sm disabled:bg-gray-500 disabled:text-white","onUpdate:modelValue":t[4]||(t[4]=function(e){return L.values.description=e})},null,8,w),[[n.vModelText,L.values.description]])]),(0,n.createElementVNode)("div",V,[k,(0,n.createElementVNode)("p",N,(0,n.toDisplayString)(L.values.total),1)])]),(0,n.createElementVNode)("div",_,[(0,n.createVNode)(G,{value:L.values.table},(0,n.createSlots)({empty:(0,n.withCtx)((function(){return[E]})),default:(0,n.withCtx)((function(){return[(0,n.createVNode)($,{field:"number",header:"Número de lote",sortable:!0}),(0,n.createVNode)($,{field:"article_name",header:"Articulo",sortable:!0}),(0,n.createVNode)($,{field:"expiration_date_c",header:"Fecha de expiración",sortable:!0}),(0,n.createVNode)($,{field:"quantity",header:"Cantidad",sortable:!0}),(0,n.createVNode)($,{field:"stock",header:"Stock",sortable:!0}),(0,n.createVNode)($,{field:"purchase_price",header:"Precio",sortable:!0}),0==Object.keys(a.details).length?((0,n.openBlock)(),(0,n.createBlock)($,{key:0,header:"Eliminar",field:"number"},{body:(0,n.withCtx)((function(e){return[(0,n.createElementVNode)("button",{onClick:function(t){return L.delete_that(e.data.number)},class:"bg-sky-400 hover:bg-sky-500 text-white font-medium rounded-lg text-sm px-4 py-2 text-center"}," X ",8,Z)]})),_:1})):(0,n.createCommentVNode)("",!0),Object.keys(a.details).length>0?((0,n.openBlock)(),(0,n.createBlock)($,{key:1,header:"Estado",field:"deleted_at"},{body:(0,n.withCtx)((function(e){return[(0,n.createElementVNode)("span",{class:(0,n.normalizeClass)(null==e.data.deleted_at?"bg-green-500 px-2 py-1 rounded-lg text-white":"bg-red-500 px-2 py-1 rounded-lg text-white")},(0,n.toDisplayString)(null==e.data.deleted_at?"Activo":"Anulado en "+e.data.deleted_at),3)]})),_:1})):(0,n.createCommentVNode)("",!0)]})),_:2},[0==Object.keys(a.details).length?{name:"header",fn:(0,n.withCtx)((function(){return[(0,n.createElementVNode)("div",j,[(0,n.createElementVNode)("div",O,[C,(0,n.createElementVNode)("p",D,(0,n.toDisplayString)(L.actualLoteNumber),1)]),(0,n.createElementVNode)("div",q,[S,(0,n.createVNode)(R,{class:"w-full text-center text-lg text-white",placeholder:"Selecciona un artículo",options:L.articles_c,optionLabel:"label",modelValue:L.valuesToPush.article,"onUpdate:modelValue":t[5]||(t[5]=function(e){return L.valuesToPush.article=e}),filter:!0},null,8,["options","modelValue"])]),(0,n.createElementVNode)("div",P,[I,(0,n.createVNode)(X,{class:"w-full text-center text-lg text-white",modelValue:L.valuesToPush.quantity,"onUpdate:modelValue":t[6]||(t[6]=function(e){return L.valuesToPush.quantity=e}),placeholder:"Ingresa la cantidad",type:"number",onChange:t[7]||(t[7]=function(e){return L.nozero()})},null,8,["modelValue"])]),(0,n.createElementVNode)("div",T,[M,(0,n.createVNode)(H,{class:"w-full text-center text-lg text-white",modelValue:L.valuesToPush.expiration_date,"onUpdate:modelValue":t[8]||(t[8]=function(e){return L.valuesToPush.expiration_date=e}),placeholder:"Ingresa la fecha de expiración",inputStyle:"text-align:center;"},null,8,["modelValue"])]),(0,n.createElementVNode)("div",B,[A,(0,n.createVNode)(X,{class:"w-full text-center text-lg text-white",modelValue:L.valuesToPush.purchase_price,"onUpdate:modelValue":t[9]||(t[9]=function(e){return L.valuesToPush.purchase_price=e}),placeholder:"Ingresa el precio",type:"number",onChange:t[10]||(t[10]=function(e){return L.nozero()})},null,8,["modelValue"])]),(0,n.createElementVNode)("div",F,[(0,n.createElementVNode)("button",{class:"bg-green-600 hover:bg-green-700 text-white font-medium rounded-lg text-sm p-2 text-center",onClick:t[11]||(t[11]=function(e){return L.addRow()})},z)])])]}))}:void 0]),1032,["value"])])])],64)}]])}}]);