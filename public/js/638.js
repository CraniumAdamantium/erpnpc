"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[638],{5486:(e,t,a)=>{a.d(t,{Z:()=>l});var n=a(3645),i=a.n(n)()((function(e){return e[1]}));i.push([e.id,"@media (min-width:768px){#cuentaBasis{flex-basis:20%;margin-left:auto}}.addButton>.p-column-header-content,.balance_assets>.p-column-header-content,.balance_debit>.p-column-header-content{align-items:right;display:inline-flex;margin-left:auto}td.addButton,td.balance_assets,td.balance_debit{display:inline!important;text-align:right!important}.p-datatable-tfoot>tr>td.addButton,.p-datatable-tfoot>tr>td.balance_assets,.p-datatable-tfoot>tr>td.balance_debit{align-items:right;display:inline-flex;display:inline!important;margin-left:auto;text-align:right!important}input::-webkit-inner-spin-button,input::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}input[type=number]{-moz-appearance:textfield}",""]);const l=i},3638:(e,t,a)=>{a.r(t),a.d(t,{default:()=>U});var n=a(6598),i={class:"px-2 mt-5"},l={class:"w-11/12 ml-auto mr-auto mt-2 transform"},c={class:"md:flex md:items-center justify-center md:justify-items-start md:flex-row inline-grid gap-2 ml-auto mr-auto"},o={id:"cuentaBasis",class:"bg-white text-black rounded-md"},s=(0,n.createTextVNode)(" No hay cuentas. "),r={class:"relative md:basis-1/3 text-gray-600 focus-within:text-gray-400"},d={class:"absolute inset-y-0 left-0 flex items-center pl-2"},u=["fill"],p=[(0,n.createElementVNode)("path",{d:"M14.5 3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-13a.5.5 0 0 1-.5-.5v-9a.5.5 0 0 1 .5-.5h13zm-13-1A1.5 1.5 0 0 0 0 3.5v9A1.5 1.5 0 0 0 1.5 14h13a1.5 1.5 0 0 0 1.5-1.5v-9A1.5 1.5 0 0 0 14.5 2h-13z"},null,-1),(0,n.createElementVNode)("path",{d:"M3 5.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zM3 8a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9A.5.5 0 0 1 3 8zm0 2.5a.5.5 0 0 1 .5-.5h6a.5.5 0 0 1 0 1h-6a.5.5 0 0 1-.5-.5z"},null,-1)],m={class:"relative md:basis-1/4 text-gray-600 focus-within:text-gray-400"},h=["disabled"],f={class:"relative md:basis-1/4 text-gray-600 focus-within:text-gray-400"},b=["disabled"],w=(0,n.createTextVNode)(" No hay detalles de comprobantes, ¡añade uno!"),g={class:"flex content-left w-full"},v={class:"flex content-center w-full"},_=[(0,n.createElementVNode)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"white",class:"bi bi-plus-lg",viewBox:"0 0 16 16"},[(0,n.createElementVNode)("path",{"fill-rule":"evenodd",d:"M8 2a.5.5 0 0 1 .5.5v5h5a.5.5 0 0 1 0 1h-5v5a.5.5 0 0 1-1 0v-5h-5a.5.5 0 0 1 0-1h5v-5A.5.5 0 0 1 8 2Z"})],-1)],x=(0,n.createElementVNode)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-x-lg",viewBox:"0 0 16 16"},[(0,n.createElementVNode)("path",{"fill-rule":"evenodd",d:"M13.854 2.146a.5.5 0 0 1 0 .708l-11 11a.5.5 0 0 1-.708-.708l11-11a.5.5 0 0 1 .708 0Z"}),(0,n.createElementVNode)("path",{"fill-rule":"evenodd",d:"M2.146 2.146a.5.5 0 0 0 0 .708l11 11a.5.5 0 0 0 .708-.708l-11-11a.5.5 0 0 0-.708 0Z"})],-1);var D=a(922),y=a(5247),N=a(6076),V=a(9669),C=a.n(V),A=a(7915),E=a(9938),B=a.n(E),S=a(4325),k=a(1678);a(6441);const I={props:{receiptData:{type:Object,default:null},glosa:{type:String,default:null},actionButtons:{type:Boolean,default:!1},editMode:{type:String,default:null}},emits:["detailsReceipt"],directives:{tooltip:A.Z},components:{Button:S.Z,DataTable:D.Z,Column:y.Z,vSelect:B(),InputText:N.Z},data:function(){return{companyLevel:null,copyGlosa:!0,accountsOptions:[],newDetail:{id_account:null,glosa:null,balance_debit:0,balance_assets:0},idSelectedAccount:null,receipts:[],coinCompanyData:[],selectedReceipt:[],filters:{id_coincompany:"",id_account:"",comment:"",balance_debit:"",balance_assets:""},accounts:[],ignoreThisAccounts:[]}},methods:{restrictDecimal:function(e){var t=e.toString().match(/^\d+\.?\d{0,2}/);return t?t[0]:e},isNumber:function(e){var t=(e=e||window.event).which?e.which:e.keyCode;if(!(t>31&&(t<48||t>57)&&46!==t))return!0;e.preventDefault()},deleteThisItem:function(e){var t=this,a=this.ignoreThisAccounts.find((function(a){return a==t.receipts[e].id_account}));a&&this.ignoreThisAccounts.splice(this.ignoreThisAccounts.indexOf(a),1),this.setAccounts(),this.receipts.splice(e,1),localStorage.setItem("detailsReceipt",JSON.stringify(this.receipts))},calculateAssets:function(){return this.receipts.reduce((function(e,t){return e+Number(t.balance_assets)}),0)},calculateDebit:function(){return this.receipts.reduce((function(e,t){return e+Number(t.balance_debit)}),0)},onCellEditComplete:function(e){if(""!=e.newData.comment.trim())if(isNaN(e.newData.balance_debit)||isNaN(e.newData.balance_assets)||""===e.newData.balance_assets||""===e.newData.balance_debit||0==e.newData.balance_debit&&0==e.newData.balance_assets)k.Notify.failure("El número debe ser mayor a 0");else{var t=this.receipts.findIndex((function(t){return t.id_account==e.data.id_account&&t.comment==e.data.comment&&t.balance_debit==e.data.balance_debit&&t.balance_assets==e.data.balance_assets}));this.receipts[t]=e.newData,this.newDetail.comment=this.receipts[t].comment,this.receipts[t].balance_debit>0&&e.newValue==this.receipts[t].balance_debit&&(this.receipts[t].balance_assets=0,this.receipts[t].balance_debit=parseFloat(this.receipts[t].balance_debit)),this.receipts[t].balance_assets>0&&e.newValue==this.receipts[t].balance_assets&&(this.receipts[t].balance_debit=0,this.receipts[t].balance_assets=parseFloat(this.receipts[t].balance_assets))}else k.Notify.failure("Ingresa una glosa")},getReceipts:function(){var e=this;this.receiptData.id_receipt?C().get(route("receiptdetails.api.read",this.receiptData.id_receipt)).then((function(t){console.log("Recibos",t.data),e.receipts=t.data})):this.setIfExist()},setIfExist:function(){this.receipts=localStorage.getItem("detailsReceipt")?JSON.parse(localStorage.getItem("detailsReceipt")):[],this.$emit("detailsReceipt",this.receipts),this.ignoreThisAccounts=localStorage.getItem("ignoredAccounts")?JSON.parse(localStorage.getItem("ignoredAccounts")):[]},addReceiptDetail:function(){var e=this;null!=this.idSelectedAccount&&""!=this.idSelectedAccount?0!=this.newDetail.balance_debit||0!=this.newDetail.balance_assets?this.newDetail.balance_debit>0&&this.newDetail.balance_assets>0?k.Notify.failure("Uno de los 2 debe ser mayor a cero y el otro 0."):(""==this.newDetail.balance_debit&&(this.newDetail.balance_debit=0),""==this.newDetail.balance_assets&&(this.newDetail.balance_assets=0),null!=this.newDetail.comment&&""!==this.newDetail.comment.trim()?(this.newDetail.id_account=this.idSelectedAccount.value,this.newDetail.name_account=this.idSelectedAccount.label,this.receipts.push(this.newDetail),this.newDetail={id_account:null,comment:this.newDetail.comment,balance_debit:0,balance_assets:0},this.ignoreThisAccounts.push(this.idSelectedAccount.value),this.accountsOptions=this.accountsOptions.filter((function(t){return t.value!=e.idSelectedAccount.value})),this.idSelectedAccount=""):k.Notify.failure("Ingresa una glosa")):k.Notify.failure("Debe o haber deben ser mayor a cero"):k.Notify.failure("Selecciona una cuenta")},setAccounts:function(){var e=this;this.accountsOptions=this.accounts.filter((function(t){return!e.ignoreThisAccounts.includes(t.id_account)&&t.level==e.companyLevel})),this.accountsOptions=this.accountsOptions.map((function(e){return{value:e.id_account,label:"".concat(e.code," - ").concat(e.name)}}))},getAccounts:function(){var e=this,t=window.location.pathname.split("/").pop();console.log(t),C().get(route("accounts.api.read",t)).then((function(t){e.accounts=t.data.company.accounts,e.companyLevel=t.data.company.level,e.setAccounts()}))}},watch:{receiptData:function(e){console.log("id_receipt",e.id_receipt),e&&this.getReceipts()},glosa:function(e){this.copyGlosa&&(this.newDetail.comment=e)}},mounted:function(){this.getAccounts(),this.getReceipts()}};var T=a(3379),M=a.n(T),R=a(5486),O={insert:"head",singleton:!1};M()(R.Z,O);R.Z.locals;const U=(0,a(3744).Z)(I,[["render",function(e,t,a,D,y,N){var V=(0,n.resolveComponent)("vSelect"),C=(0,n.resolveComponent)("Column"),A=(0,n.resolveComponent)("InputText"),E=(0,n.resolveComponent)("Button"),B=(0,n.resolveComponent)("DataTable"),S=(0,n.resolveDirective)("tooltip");return(0,n.openBlock)(),(0,n.createElementBlock)("div",i,[(0,n.createElementVNode)("div",l,[(0,n.createVNode)(B,{resizableColumns:!0,columnResizeMode:"fit",class:"p-datatable-sm",value:y.receipts,dataKey:"id_coincompany",scrollable:!0,scrollHeight:"350px",responsiveLayout:"scroll",filters:y.filters,"onUpdate:filters":t[10]||(t[10]=function(e){return y.filters=e}),editMode:a.editMode,onCellEditComplete:N.onCellEditComplete},{header:(0,n.withCtx)((function(){return[(0,n.createElementVNode)("div",c,[(0,n.withDirectives)(((0,n.openBlock)(),(0,n.createElementBlock)("div",o,[(0,n.createVNode)(V,{modelValue:y.idSelectedAccount,"onUpdate:modelValue":t[0]||(t[0]=function(e){return y.idSelectedAccount=e}),options:y.accountsOptions,placeholder:"Selecciona una cuenta"},{"no-options":(0,n.withCtx)((function(){return[s]})),_:1},8,["modelValue","options"])])),[[S,"Seleccione una cuenta"]]),(0,n.withDirectives)(((0,n.openBlock)(),(0,n.createElementBlock)("div",r,[(0,n.createElementVNode)("span",d,[(0,n.createElementVNode)("button",{onClick:t[1]||(t[1]=function(){return y.copyGlosa&&y.copyGlosa.apply(y,arguments)})},[((0,n.openBlock)(),(0,n.createElementBlock)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:y.copyGlosa?"#2196f3":"#bdbdbd",class:"bi bi-card-text",viewBox:"0 0 16 16"},p,8,u))])]),(0,n.withDirectives)((0,n.createElementVNode)("input",{"onUpdate:modelValue":t[2]||(t[2]=function(e){return y.newDetail.comment=e}),placeholder:"Añade una glosa",class:"w-full py-2 text-sm rounded-md pl-10 focus:outline-none focus:bg-white focus:text-gray-900",maxlength:"100"},null,512),[[n.vModelText,y.newDetail.comment]])])),[[S,"Glosa para el detalle"]]),(0,n.withDirectives)(((0,n.openBlock)(),(0,n.createElementBlock)("div",m,[(0,n.withDirectives)((0,n.createElementVNode)("input",{style:{"text-align":"right"},type:"number","onUpdate:modelValue":t[3]||(t[3]=function(e){return y.newDetail.balance_debit=e}),onKeypress:t[4]||(t[4]=function(e){return N.isNumber(e)}),onInput:t[5]||(t[5]=function(e){return y.newDetail.balance_debit=N.restrictDecimal(y.newDetail.balance_debit)}),disabled:y.newDetail.balance_assets>0,placeholder:"Debe",class:"w-full py-2 text-sm rounded-md pr-3 focus:outline-none focus:bg-white focus:text-gray-900"},null,40,h),[[n.vModelText,y.newDetail.balance_debit]])])),[[S,"Debe para el detalle",void 0,{top:!0}]]),(0,n.withDirectives)(((0,n.openBlock)(),(0,n.createElementBlock)("div",f,[(0,n.withDirectives)((0,n.createElementVNode)("input",{style:{"text-align":"right"},type:"number","onUpdate:modelValue":t[6]||(t[6]=function(e){return y.newDetail.balance_assets=e}),onKeypress:t[7]||(t[7]=function(e){return N.isNumber(e)}),onInput:t[8]||(t[8]=function(e){return y.newDetail.balance_assets=N.restrictDecimal(y.newDetail.balance_assets)}),disabled:y.newDetail.balance_debit>0,placeholder:"Haber",class:"py-2 text-sm rounded-md pr-3 w-full focus:outline-none focus:bg-white focus:text-gray-900"},null,40,b),[[n.vModelText,y.newDetail.balance_assets]])])),[[S,"Haber para el detalle",void 0,{top:!0}]])])]})),empty:(0,n.withCtx)((function(){return[w]})),default:(0,n.withCtx)((function(){return[(0,n.createVNode)(C,{field:"name_account",header:"Cuenta"},{body:(0,n.withCtx)((function(e){return[(0,n.createElementVNode)("div",g,[(0,n.createElementVNode)("p",null,(0,n.toDisplayString)(e.data[e.field]),1)])]})),_:1}),(0,n.createVNode)(C,{field:"comment",header:"Glosa"},{editor:(0,n.withCtx)((function(e){return[(0,n.createVNode)(A,{modelValue:e.data[e.field],"onUpdate:modelValue":function(t){return e.data[e.field]=t},maxlength:"100"},null,8,["modelValue","onUpdate:modelValue"])]})),_:1}),(0,n.createVNode)(C,{class:"balance_debit",field:"balance_debit",header:"Debe",footerStyle:"",footer:"Total: ".concat(N.calculateDebit())},{editor:(0,n.withCtx)((function(e){return[(0,n.createElementVNode)("div",v,[(0,n.createVNode)(A,{maxlength:"12",type:"text",class:"text-right mx-auto",modelValue:e.data[e.field],"onUpdate:modelValue":function(t){return e.data[e.field]=t},onInput:function(t){return e.data[e.field]=N.restrictDecimal(e.data[e.field])}},null,8,["modelValue","onUpdate:modelValue","onInput"])])]})),_:1},8,["footer"]),(0,n.createVNode)(C,{class:"balance_assets",field:"balance_assets",header:"Haber",footer:"Total: ".concat(N.calculateAssets())},{editor:(0,n.withCtx)((function(e){return[(0,n.createVNode)(A,{maxlength:"12",type:"text",class:"text-right mx-auto",modelValue:e.data[e.field],"onUpdate:modelValue":function(t){return e.data[e.field]=t},onInput:function(t){return e.data[e.field]=N.restrictDecimal(e.data[e.field])}},null,8,["modelValue","onUpdate:modelValue","onInput"])]})),_:1},8,["footer"]),(0,n.createVNode)(C,{class:"addButton",hidden:a.actionButtons,footer:N.calculateAssets()-N.calculateDebit()==0?"✅":"≠"},{header:(0,n.withCtx)((function(){return[(0,n.withDirectives)(((0,n.openBlock)(),(0,n.createElementBlock)("button",{class:"text-white disabled:bg-green-800 bg-green-500 hover:bg-green-600 font-medium rounded-lg text-sm px-2 py-2 text-center mr-2",onClick:t[9]||(t[9]=function(){return N.addReceiptDetail&&N.addReceiptDetail.apply(N,arguments)})},_)),[[S,{value:"Agregar detalle",class:"text-center"},void 0,{bottom:!0}]])]})),body:(0,n.withCtx)((function(e){return[(0,n.createVNode)(E,{type:"button",onClick:function(t){return N.deleteThisItem(e.index)}},{default:(0,n.withCtx)((function(){return[x]})),_:2},1032,["onClick"])]})),_:1},8,["hidden","footer"])]})),_:1},8,["value","filters","editMode","onCellEditComplete"])])])}]])}}]);