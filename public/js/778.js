"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[778,717],{7646:(e,t,a)=>{a.d(t,{Z:()=>l});var n=a(3645),o=a.n(n)()((function(e){return e[1]}));o.push([e.id,".p-inputtext:disabled{background-color:#6b7280!important;color:#fff!important;opacity:1!important}",""]);const l=o},5778:(e,t,a)=>{a.r(t),a.d(t,{default:()=>ae});var n=a(6598),o={class:"px-4 mt-5"},l={class:"w-12/12 ml-auto mr-auto mt-2 transform"},r={class:"flex"},i={class:"text-2xl text-white"},c={class:"flex ml-auto items-center"},d=[(0,n.createElementVNode)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"white",viewBox:"0 0 16 16"},[(0,n.createElementVNode)("path",{d:"M15.683 3a2 2 0 0 0-2-2h-7.08a2 2 0 0 0-1.519.698L.241 7.35a1 1 0 0 0 0 1.302l4.843 5.65A2 2 0 0 0 6.603 15h7.08a2 2 0 0 0 2-2V3zM5.829 5.854a.5.5 0 1 1 .707-.708l2.147 2.147 2.146-2.147a.5.5 0 1 1 .707.708L9.39 8l2.146 2.146a.5.5 0 0 1-.707.708L8.683 8.707l-2.147 2.147a.5.5 0 0 1-.707-.708L7.976 8 5.829 5.854z"})],-1)],s=["disabled"],u=[(0,n.createElementVNode)("svg",{width:"24",height:"24",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[(0,n.createElementVNode)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 13h6m-3-3v6m5 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)],m={key:0,class:"disabled:bg-indigo-800 bg-indigo-700 hover:bg-indigo-600 text-white font-medium rounded-lg text-sm px-2 py-2 text-center mr-2",id:"showReport"},p=[(0,n.createElementVNode)("svg",{width:"24",height:"24",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[(0,n.createElementVNode)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"})],-1)],f=[(0,n.createElementVNode)("svg",{width:"24",height:"24",fill:"none",stroke:"white",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[(0,n.createElementVNode)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)],h={class:"flex flex-col"},b={class:"w-11/12 mx-auto flex flex-row m-4"},y={class:"flex flex-col mt-2 mr-2"},g=(0,n.createElementVNode)("p",{class:"text-base text-white"},"Fecha",-1),v={class:"flex flex-col m-2"},w=(0,n.createElementVNode)("p",{class:"text-base text-white"},"Descripción",-1),x=["disabled"],V={class:"flex flex-col ml-auto mt-2"},k=(0,n.createElementVNode)("p",{class:"text-base text-white"},"Total",-1),N={class:"mt-1 text-xl text-white text-center self-center"},_={class:"w-11/12 mx-auto"},E=(0,n.createTextVNode)(" No hay artículos, añade uno! "),C={class:"flex flex-row justify-between gap-2 items-center"},j={class:"self-end w-full"},O=(0,n.createElementVNode)("p",{class:"text-center"},"Artículo",-1),q={class:"self-end w-full"},I=(0,n.createElementVNode)("p",{class:"text-center"},"Cantidad",-1),D={class:"self-end w-full"},P=(0,n.createElementVNode)("p",{class:"text-center"},"Precio",-1),S={class:"self-end mb-1"},B=[(0,n.createElementVNode)("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[(0,n.createElementVNode)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 13h6m-3-3v6m5 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)],T=["onClick"];var A=a(9680),M=a(6635),L=a(6076),z=a(2262),U=a(6252),Z=a(8223),F=a(922),H=a(5247),R=a(5090);function X(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function $(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?X(Object(a),!0).forEach((function(t){G(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):X(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function G(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function J(e){return function(e){if(Array.isArray(e))return K(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return K(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return K(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function K(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}const Q={components:{InputText:L.Z,Calendar:Z.Z,DataTable:F.Z,Column:H.Z,Dropdown:M.Z},props:{company:{type:Object,required:!0},userData:{type:Object,required:!0},details:{type:Object,default:{}}},emits:["goback","delete"],setup:function(e,t){var a=t.emit,n=(0,U.Fl)({get:function(){if(!(Object.keys(e.details).length>0)){var t=[];return e.company.notes.filter((function(e){return"1"==e.type&&null==e.deleted_at})).forEach((function(e){e.notes_lot.forEach((function(e){console.log(e,"Lote?"),e.pivot.quantity>0&&t.push(e)}))})),console.log(t),t.map((function(e){return{label:e.name+" - Lote "+e.pivot.id_note_lot+" / ["+e.pivot.quantity+"]",value:e.pivot.id_note_lot,id_article:e.id_article,quantity:e.pivot.quantity,name:e.name}})).filter((function(e){return console.log(e,"pruebita"),!o.table.some((function(t){return t.id_article==e.id_article}))}))}}}),o=(0,z.qj)({number:(0,U.Fl)((function(){return 0==e.company.notes.length?1:Math.max.apply(Math,J(e.company.notes.filter((function(e){return 2==e.type})).map((function(e){return e.number}))))+1})),date:"",description:"",total:(0,U.Fl)((function(){return o.table.map((function(e){return e.sale_price*e.quantity})).reduce((function(e,t){return parseFloat(e)+parseFloat(t)}),0)})),id_receipt:"",table:[]}),l=(0,z.qj)({article:{},expiration_date:"",quantity:1,sale_price:1}),r=function(){l.article={},l.quantity=1,l.sale_price=1},i=function(){var e=!1;return l.quantity=parseInt(l.quantity),l.stock=parseInt(l.stock),(""==l.quantity||l.quantity<=0)&&(l.quantity=1,R.Notify.warning("La cantidad no puede ser 0 o menos, estableciendo 1"),e=!0),(""==l.sale_price||l.sale_price<=0)&&(R.Notify.warning("El precio de venta no puede ser 0 o negativo, estableciendo 1"),l.sale_price=1,e=!0),console.log(l.article),l.quantity>l.article.quantity&&(R.Notify.failure("La cantidad no puede ser mayor al stock del artículo"),e=!0),e};(0,U.bv)((function(){console.log("Montado",o.table),Object.keys(e.details).length>0&&(e.details.details.forEach((function(e){o.table.push({article_name:e.name,quantity:e.pivot.quantity,id_note_lot:e.pivot.id_note_lot,sale_price:e.pivot.sale_price,deleted_at:e.pivot.deleted_at})})),o.description=e.details.description,o.date=e.details.date)}));return{onCellEditComplete:function(e){if("quantity"==e.field){if(console.log(e),""==e.newValue||e.newValue<=0)return void R.Notify.failure("Ingresa una cantidad mayor a 0");if(e.newValue>e.data.article.quantity)return void R.Notify.failure("La cantidad no puede ser mayor al stock del artículo. Stock: "+e.data.article.quantity);o.table[e.index].stock=e.newValue,o.table[e.index].quantity=e.newValue}if("sale_price"==e.field){if(""==e.newValue||e.newValue<=0)return void R.Notify.failure("Ingresa un precio mayor a 0");o.table[e.index].purchase_price=e.newValue}},emitDelete:function(){a("delete"),a("goback")},save:function(){var t=!0;if(0==o.table.length&&(R.Notify.failure("Ingresa al menos un artículo"),t=!1),""==o.date&&(R.Notify.failure("Ingresa una fecha"),t=!1),(""==o.description||o.description.length<3)&&(R.Notify.failure("Ingresa una descripción de al menos 3 carácteres"),t=!1),t){var n={};o.table.forEach((function(e){n[e.id_article]={quantity:e.quantity,id_note_lot:e.id_note_lot,sale_price:e.sale_price}}));var l={id_company:e.company.id_company,date:o.date,description:o.description,table:n,total:o.total};console.log("Data enviada",l),A.Inertia.post(route("notes.api.create_v"),l,{onSuccess:function(){R.Notify.success("Nota de venta creada"),a("goback")},onError:function(e){for(var t in e)R.Notify.failure(e[t])}})}},delete_that:function(e){var t=o.table.findIndex((function(t){return t.id_article==e}));o.table.splice(t,1)},nozero:i,goback:function(){a("goback")},values:o,valuesToPush:l,articles_c:n,addRow:function(){var e;i()||(e=!0,(""==l.quantity||l.quantity<=0)&&(R.Notify.failure("Ingresa una cantidad mayor a 0"),e=!1),(""==l.sale_price||l.sale_price<=0)&&(R.Notify.failure("Ingresa un precio"),e=!1),0==Object.keys(l.article).length&&(R.Notify.failure("Ingresa un artículo"),e=!1),(""==l.stock||l.stock<=0)&&(R.Notify.failure("Ingresa un stock mayor a 0"),e=!1),e&&(o.table.push($($({},l),{},{id_article:l.article.id_article,article_name:l.article.name,id_note_lot:l.article.value})),r()))}}}};var W=a(3379),Y=a.n(W),ee=a(7646),te={insert:"head",singleton:!1};Y()(ee.Z,te);ee.Z.locals;const ae=(0,a(3744).Z)(Q,[["render",function(e,t,a,A,M,L){var z=(0,n.resolveComponent)("Calendar"),U=(0,n.resolveComponent)("Dropdown"),Z=(0,n.resolveComponent)("InputText"),F=(0,n.resolveComponent)("Column"),H=(0,n.resolveComponent)("DataTable");return(0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,null,[(0,n.createElementVNode)("div",o,[(0,n.createElementVNode)("div",l,[(0,n.createElementVNode)("div",r,[(0,n.createElementVNode)("h4",i,(0,n.toDisplayString)(Object.keys(a.details).length>0?"Viendo ":"Creando ")+" nota de venta Nº "+(0,n.toDisplayString)(Object.keys(a.details).length>0?a.details.number:A.values.number)+" "+(0,n.toDisplayString)(Object.keys(a.details).length>0?" | "+a.details.deleted_at:null),1),(0,n.createElementVNode)("div",c,[(0,n.createElementVNode)("button",{class:"bg-sky-600 hover:bg-sky-700 text-white font-medium rounded-lg text-sm p-2 text-center mr-2",onClick:t[0]||(t[0]=function(e){return A.goback()})},d),(0,n.createElementVNode)("button",{class:"bg-green-600 hover:bg-green-700 text-white font-medium rounded-lg text-sm p-2 text-center mr-2",onClick:t[1]||(t[1]=function(e){return A.save()}),disabled:Object.keys(a.details).length>0},u,8,s),Object.keys(a.details).length>0?((0,n.openBlock)(),(0,n.createElementBlock)("button",m,p)):(0,n.createCommentVNode)("",!0),Object.keys(a.details).length>0&&"Activo"==a.details.deleted_at?((0,n.openBlock)(),(0,n.createElementBlock)("button",{key:1,id:"trash_receipt",class:"text-white disabled:bg-red-800 bg-red-500 hover:bg-red-600 font-medium rounded-lg text-sm px-2 py-2 text-center",onClick:t[2]||(t[2]=function(e){return A.emitDelete()})},f)):(0,n.createCommentVNode)("",!0)])])])]),(0,n.createElementVNode)("div",h,[(0,n.createElementVNode)("div",b,[(0,n.createElementVNode)("div",y,[g,(0,n.createVNode)(z,{disabled:Object.keys(a.details).length>0,inputStyle:"background: white; color: black;",modelValue:A.values.date,"onUpdate:modelValue":t[3]||(t[3]=function(e){return A.values.date=e}),dateFormat:"dd/mm/yy"},null,8,["disabled","modelValue"])]),(0,n.createElementVNode)("div",v,[w,(0,n.withDirectives)((0,n.createElementVNode)("input",{disabled:Object.keys(a.details).length>0,class:"p-2 text-black rounded-sm disabled:bg-gray-500 disabled:text-white","onUpdate:modelValue":t[4]||(t[4]=function(e){return A.values.description=e})},null,8,x),[[n.vModelText,A.values.description]])]),(0,n.createElementVNode)("div",V,[k,(0,n.createElementVNode)("p",N,(0,n.toDisplayString)(A.values.total),1)])]),(0,n.createElementVNode)("div",_,[(0,n.createVNode)(H,{value:A.values.table,editMode:Object.keys(a.details).length>0?"":"cell",onCellEditComplete:A.onCellEditComplete},(0,n.createSlots)({empty:(0,n.withCtx)((function(){return[E]})),default:(0,n.withCtx)((function(){return[(0,n.createVNode)(F,{field:"article_name",header:"Articulo",sortable:!0}),(0,n.createVNode)(F,{field:"quantity",header:"Cantidad",sortable:!0},{editor:(0,n.withCtx)((function(e){return[(0,n.createVNode)(Z,{modelValue:e.data[e.field],"onUpdate:modelValue":function(t){return e.data[e.field]=t}},null,8,["modelValue","onUpdate:modelValue"])]})),_:1}),(0,n.createVNode)(F,{field:"id_note_lot",header:"Lote Nº",sortable:!0}),(0,n.createVNode)(F,{field:"sale_price",header:"Precio",sortable:!0},{editor:(0,n.withCtx)((function(e){return[(0,n.createVNode)(Z,{modelValue:e.data[e.field],"onUpdate:modelValue":function(t){return e.data[e.field]=t}},null,8,["modelValue","onUpdate:modelValue"])]})),_:1}),0==Object.keys(a.details).length?((0,n.openBlock)(),(0,n.createBlock)(F,{key:0,header:"Eliminar",field:"number"},{body:(0,n.withCtx)((function(e){return[(0,n.createElementVNode)("button",{onClick:function(t){return A.delete_that(e.data.id_article)},class:"bg-sky-400 hover:bg-sky-500 text-white font-medium rounded-lg text-sm px-4 py-2 text-center"}," X ",8,T)]})),_:1})):(0,n.createCommentVNode)("",!0),Object.keys(a.details).length>0?((0,n.openBlock)(),(0,n.createBlock)(F,{key:1,header:"Estado",field:"deleted_at"},{body:(0,n.withCtx)((function(e){return[(0,n.createElementVNode)("span",{class:(0,n.normalizeClass)(null==e.data.deleted_at?"bg-green-500 px-2 py-1 rounded-lg text-white":"bg-red-500 px-2 py-1 rounded-lg text-white")},(0,n.toDisplayString)(null==e.data.deleted_at?"Activo":"Anulado en "+e.data.deleted_at),3)]})),_:1})):(0,n.createCommentVNode)("",!0)]})),_:2},[0==Object.keys(a.details).length?{name:"header",fn:(0,n.withCtx)((function(){return[(0,n.createElementVNode)("div",C,[(0,n.createElementVNode)("div",j,[O,(0,n.createVNode)(U,{class:"w-full text-center text-lg text-white",placeholder:"Selecciona un artículo",options:A.articles_c,optionLabel:"label",modelValue:A.valuesToPush.article,"onUpdate:modelValue":t[5]||(t[5]=function(e){return A.valuesToPush.article=e}),filter:!0},null,8,["options","modelValue"])]),(0,n.createElementVNode)("div",q,[I,(0,n.createVNode)(Z,{class:"w-full text-center text-lg text-white",modelValue:A.valuesToPush.quantity,"onUpdate:modelValue":t[6]||(t[6]=function(e){return A.valuesToPush.quantity=e}),placeholder:"Ingresa la cantidad",type:"number",onChange:t[7]||(t[7]=function(e){return A.nozero()})},null,8,["modelValue"])]),(0,n.createElementVNode)("div",D,[P,(0,n.createVNode)(Z,{class:"w-full text-center text-lg text-white",modelValue:A.valuesToPush.sale_price,"onUpdate:modelValue":t[8]||(t[8]=function(e){return A.valuesToPush.sale_price=e}),placeholder:"Ingresa el precio",type:"number",onChange:t[9]||(t[9]=function(e){return A.nozero()})},null,8,["modelValue"])]),(0,n.createElementVNode)("div",S,[(0,n.createElementVNode)("button",{class:"bg-green-600 hover:bg-green-700 text-white font-medium rounded-lg text-sm p-2 text-center",onClick:t[10]||(t[10]=function(e){return A.addRow()})},B)])])]}))}:void 0]),1032,["value","editMode","onCellEditComplete"])])])],64)}]])}}]);