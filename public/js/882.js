"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[882,446],{3859:(e,t,n)=>{n.d(t,{Z:()=>r});var a=n(3645),o=n.n(a)()((function(e){return e[1]}));o.push([e.id,".p-inputtext:disabled{background-color:#6b7280!important;color:#fff!important;opacity:1!important}",""]);const r=o},882:(e,t,n)=>{n.r(t),n.d(t,{default:()=>ne});var a=n(6598),o={class:"px-4 mt-5"},r={class:"w-12/12 ml-auto mr-auto mt-2 transform"},l={class:"flex"},i={class:"text-2xl text-white"},c={class:"flex ml-auto items-center"},d=[(0,a.createElementVNode)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"white",viewBox:"0 0 16 16"},[(0,a.createElementVNode)("path",{d:"M15.683 3a2 2 0 0 0-2-2h-7.08a2 2 0 0 0-1.519.698L.241 7.35a1 1 0 0 0 0 1.302l4.843 5.65A2 2 0 0 0 6.603 15h7.08a2 2 0 0 0 2-2V3zM5.829 5.854a.5.5 0 1 1 .707-.708l2.147 2.147 2.146-2.147a.5.5 0 1 1 .707.708L9.39 8l2.146 2.146a.5.5 0 0 1-.707.708L8.683 8.707l-2.147 2.147a.5.5 0 0 1-.707-.708L7.976 8 5.829 5.854z"})],-1)],s=["disabled"],u=[(0,a.createElementVNode)("svg",{width:"24",height:"24",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[(0,a.createElementVNode)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 13h6m-3-3v6m5 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)],m={key:0,class:"disabled:bg-indigo-800 bg-indigo-700 hover:bg-indigo-600 text-white font-medium rounded-lg text-sm px-2 py-2 text-center mr-2",id:"showReport"},p=[(0,a.createElementVNode)("svg",{width:"24",height:"24",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[(0,a.createElementVNode)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"})],-1)],f=[(0,a.createElementVNode)("svg",{width:"24",height:"24",fill:"none",stroke:"white",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[(0,a.createElementVNode)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)],h={class:"flex flex-col"},b={class:"w-11/12 mx-auto flex flex-row m-4"},g={class:"flex flex-col mt-2 mr-2"},y=(0,a.createElementVNode)("p",{class:"text-base text-white"},"Fecha",-1),v={class:"flex flex-col m-2"},x=(0,a.createElementVNode)("p",{class:"text-base text-white"},"Descripción",-1),w=["disabled"],k={class:"flex flex-col ml-auto mt-2"},V=(0,a.createElementVNode)("p",{class:"text-base text-white"},"Total",-1),N={class:"mt-1 text-xl text-white text-center self-center"},_={class:"w-11/12 mx-auto"},E=(0,a.createTextVNode)(" No hay artículos, añade uno! "),j={class:"flex flex-row justify-between gap-2 items-center"},O={class:"self-end w-full"},C=(0,a.createElementVNode)("p",{class:"text-center"},"Artículo",-1),q={class:"self-end w-full"},D=(0,a.createElementVNode)("p",{class:"text-center"},"Cantidad",-1),I={class:"self-end w-full"},P=(0,a.createElementVNode)("p",{class:"text-center"},"Precio",-1),S={class:"self-end mb-1"},B=[(0,a.createElementVNode)("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[(0,a.createElementVNode)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 13h6m-3-3v6m5 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)],T=["onClick"];var A=n(9680),M=n(6635),L=n(6076),z=n(2262),Z=n(6252),F=n(8223),H=n(922),U=n(5247),R=n(5090);function X(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function $(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?X(Object(n),!0).forEach((function(t){G(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):X(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function G(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function J(e){return function(e){if(Array.isArray(e))return K(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return K(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return K(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function K(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}const Q={components:{InputText:L.Z,Calendar:F.Z,DataTable:H.Z,Column:U.Z,Dropdown:M.Z},props:{company:{type:Object,required:!0},userData:{type:Object,required:!0},details:{type:Object,default:{}}},emits:["goback","delete"],setup:function(e,t){var n=t.emit,a=(0,Z.Fl)({get:function(){if(!(Object.keys(e.details).length>0)){var t=[];return e.company.notes.filter((function(e){return"1"==e.type&&null==e.deleted_at})).forEach((function(e){e.notes_lot.forEach((function(e){console.log(e,"Lote?"),e.pivot.quantity>0&&t.push(e)}))})),console.log(t),t.map((function(e){return{label:e.name+" - Lote "+e.pivot.id_note_lot+" / ["+e.pivot.quantity+"]",value:e.pivot.id_note_lot,id_article:e.id_article,quantity:e.pivot.quantity,name:e.name}})).filter((function(e){return console.log(e,"pruebita"),!o.table.some((function(t){return t.id_article==e.id_article}))}))}}}),o=(0,z.qj)({number:(0,Z.Fl)((function(){return 0==e.company.notes.length?1:Math.max.apply(Math,J(e.company.notes.filter((function(e){return 2==e.type})).map((function(e){return e.number}))))+1})),date:"",description:"",total:(0,Z.Fl)((function(){return o.table.map((function(e){return e.sale_price*e.quantity})).reduce((function(e,t){return parseFloat(e)+parseFloat(t)}),0)})),id_receipt:"",table:[]}),r=(0,z.qj)({article:{},expiration_date:"",quantity:1,sale_price:1}),l=function(){r.article={},r.quantity=1,r.sale_price=1},i=function(){var e=!1;return r.quantity=parseInt(r.quantity),r.stock=parseInt(r.stock),(""==r.quantity||r.quantity<=0)&&(r.quantity=1,R.Notify.warning("La cantidad no puede ser 0 o menos, estableciendo 1"),e=!0),(""==r.sale_price||r.sale_price<=0)&&(R.Notify.warning("El precio de venta no puede ser 0 o negativo, estableciendo 1"),r.sale_price=1,e=!0),console.log(r.article),r.quantity>r.article.quantity&&(R.Notify.failure("La cantidad no puede ser mayor al stock del artículo"),e=!0),e};(0,Z.bv)((function(){console.log("Montado",o.table),Object.keys(e.details).length>0&&(e.details.details.forEach((function(e){o.table.push({article_name:e.name,quantity:e.pivot.quantity,id_note_lot:e.pivot.id_note_lot,sale_price:e.pivot.sale_price,deleted_at:e.pivot.deleted_at})})),o.description=e.details.description,o.date=e.details.date)}));return{emitDelete:function(){n("delete"),n("goback")},save:function(){var t=!0;if(0==o.table.length&&(R.Notify.failure("Ingresa al menos un artículo"),t=!1),""==o.date&&(R.Notify.failure("Ingresa una fecha"),t=!1),(""==o.description||o.description.length<3)&&(R.Notify.failure("Ingresa una descripción de al menos 3 carácteres"),t=!1),t){var a={};o.table.forEach((function(e){a[e.id_article]={quantity:e.quantity,id_note_lot:e.id_note_lot,sale_price:e.sale_price}}));var r={id_company:e.company.id_company,date:o.date,description:o.description,table:a,total:o.total};console.log("Data enviada",r),A.Inertia.post(route("notes.api.create_v"),r,{onSuccess:function(){R.Notify.success("Nota de venta creada"),n("goback")},onError:function(e){for(var t in e)R.Notify.failure(e[t])}})}},delete_that:function(e){var t=o.table.findIndex((function(t){return t.id_article==e}));o.table.splice(t,1)},nozero:i,goback:function(){n("goback")},values:o,valuesToPush:r,articles_c:a,addRow:function(){var e;i()||(e=!0,(""==r.quantity||r.quantity<=0)&&(R.Notify.failure("Ingresa una cantidad mayor a 0"),e=!1),(""==r.sale_price||r.sale_price<=0)&&(R.Notify.failure("Ingresa un precio"),e=!1),0==Object.keys(r.article).length&&(R.Notify.failure("Ingresa un artículo"),e=!1),(""==r.stock||r.stock<=0)&&(R.Notify.failure("Ingresa un stock mayor a 0"),e=!1),e&&(o.table.push($($({},r),{},{id_article:r.article.id_article,article_name:r.article.name,id_note_lot:r.article.value})),l()))}}}};var W=n(3379),Y=n.n(W),ee=n(3859),te={insert:"head",singleton:!1};Y()(ee.Z,te);ee.Z.locals;const ne=(0,n(3744).Z)(Q,[["render",function(e,t,n,A,M,L){var z=(0,a.resolveComponent)("Calendar"),Z=(0,a.resolveComponent)("Dropdown"),F=(0,a.resolveComponent)("InputText"),H=(0,a.resolveComponent)("Column"),U=(0,a.resolveComponent)("DataTable");return(0,a.openBlock)(),(0,a.createElementBlock)(a.Fragment,null,[(0,a.createElementVNode)("div",o,[(0,a.createElementVNode)("div",r,[(0,a.createElementVNode)("div",l,[(0,a.createElementVNode)("h4",i,(0,a.toDisplayString)(Object.keys(n.details).length>0?"Viendo ":"Creando ")+" nota de venta Nº "+(0,a.toDisplayString)(Object.keys(n.details).length>0?n.details.number:A.values.number)+" "+(0,a.toDisplayString)(Object.keys(n.details).length>0?" | "+n.details.deleted_at:null),1),(0,a.createElementVNode)("div",c,[(0,a.createElementVNode)("button",{class:"bg-sky-600 hover:bg-sky-700 text-white font-medium rounded-lg text-sm p-2 text-center mr-2",onClick:t[0]||(t[0]=function(e){return A.goback()})},d),(0,a.createElementVNode)("button",{class:"bg-green-600 hover:bg-green-700 text-white font-medium rounded-lg text-sm p-2 text-center mr-2",onClick:t[1]||(t[1]=function(e){return A.save()}),disabled:Object.keys(n.details).length>0},u,8,s),Object.keys(n.details).length>0?((0,a.openBlock)(),(0,a.createElementBlock)("button",m,p)):(0,a.createCommentVNode)("",!0),Object.keys(n.details).length>0&&"Activo"==n.details.deleted_at?((0,a.openBlock)(),(0,a.createElementBlock)("button",{key:1,id:"trash_receipt",class:"text-white disabled:bg-red-800 bg-red-500 hover:bg-red-600 font-medium rounded-lg text-sm px-2 py-2 text-center",onClick:t[2]||(t[2]=function(e){return A.emitDelete()})},f)):(0,a.createCommentVNode)("",!0)])])])]),(0,a.createElementVNode)("div",h,[(0,a.createElementVNode)("div",b,[(0,a.createElementVNode)("div",g,[y,(0,a.createVNode)(z,{disabled:Object.keys(n.details).length>0,inputStyle:"background: white; color: black;",modelValue:A.values.date,"onUpdate:modelValue":t[3]||(t[3]=function(e){return A.values.date=e}),dateFormat:"dd/mm/yy"},null,8,["disabled","modelValue"])]),(0,a.createElementVNode)("div",v,[x,(0,a.withDirectives)((0,a.createElementVNode)("input",{disabled:Object.keys(n.details).length>0,class:"p-2 text-black rounded-sm disabled:bg-gray-500 disabled:text-white","onUpdate:modelValue":t[4]||(t[4]=function(e){return A.values.description=e})},null,8,w),[[a.vModelText,A.values.description]])]),(0,a.createElementVNode)("div",k,[V,(0,a.createElementVNode)("p",N,(0,a.toDisplayString)(A.values.total),1)])]),(0,a.createElementVNode)("div",_,[(0,a.createVNode)(U,{value:A.values.table},(0,a.createSlots)({empty:(0,a.withCtx)((function(){return[E]})),default:(0,a.withCtx)((function(){return[(0,a.createVNode)(H,{field:"article_name",header:"Articulo",sortable:!0}),(0,a.createVNode)(H,{field:"quantity",header:"Cantidad",sortable:!0}),(0,a.createVNode)(H,{field:"id_note_lot",header:"Lote Nº",sortable:!0}),(0,a.createVNode)(H,{field:"sale_price",header:"Precio",sortable:!0}),0==Object.keys(n.details).length?((0,a.openBlock)(),(0,a.createBlock)(H,{key:0,header:"Eliminar",field:"number"},{body:(0,a.withCtx)((function(e){return[(0,a.createElementVNode)("button",{onClick:function(t){return A.delete_that(e.data.id_article)},class:"bg-sky-400 hover:bg-sky-500 text-white font-medium rounded-lg text-sm px-4 py-2 text-center"}," X ",8,T)]})),_:1})):(0,a.createCommentVNode)("",!0),Object.keys(n.details).length>0?((0,a.openBlock)(),(0,a.createBlock)(H,{key:1,header:"Estado",field:"deleted_at"},{body:(0,a.withCtx)((function(e){return[(0,a.createElementVNode)("span",{class:(0,a.normalizeClass)(null==e.data.deleted_at?"bg-green-500 px-2 py-1 rounded-lg text-white":"bg-red-500 px-2 py-1 rounded-lg text-white")},(0,a.toDisplayString)(null==e.data.deleted_at?"Activo":"Anulado en "+e.data.deleted_at),3)]})),_:1})):(0,a.createCommentVNode)("",!0)]})),_:2},[0==Object.keys(n.details).length?{name:"header",fn:(0,a.withCtx)((function(){return[(0,a.createElementVNode)("div",j,[(0,a.createElementVNode)("div",O,[C,(0,a.createVNode)(Z,{class:"w-full text-center text-lg text-white",placeholder:"Selecciona un artículo",options:A.articles_c,optionLabel:"label",modelValue:A.valuesToPush.article,"onUpdate:modelValue":t[5]||(t[5]=function(e){return A.valuesToPush.article=e}),filter:!0},null,8,["options","modelValue"])]),(0,a.createElementVNode)("div",q,[D,(0,a.createVNode)(F,{class:"w-full text-center text-lg text-white",modelValue:A.valuesToPush.quantity,"onUpdate:modelValue":t[6]||(t[6]=function(e){return A.valuesToPush.quantity=e}),placeholder:"Ingresa la cantidad",type:"number",onChange:t[7]||(t[7]=function(e){return A.nozero()})},null,8,["modelValue"])]),(0,a.createElementVNode)("div",I,[P,(0,a.createVNode)(F,{class:"w-full text-center text-lg text-white",modelValue:A.valuesToPush.sale_price,"onUpdate:modelValue":t[8]||(t[8]=function(e){return A.valuesToPush.sale_price=e}),placeholder:"Ingresa el precio",type:"number",onChange:t[9]||(t[9]=function(e){return A.nozero()})},null,8,["modelValue"])]),(0,a.createElementVNode)("div",S,[(0,a.createElementVNode)("button",{class:"bg-green-600 hover:bg-green-700 text-white font-medium rounded-lg text-sm p-2 text-center",onClick:t[10]||(t[10]=function(e){return A.addRow()})},B)])])]}))}:void 0]),1032,["value"])])])],64)}]])}}]);